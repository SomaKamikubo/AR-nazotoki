<html>
  <head>
    <title>Test io</title>
  </head>
  <body>
    test io.<br>
    <button id="emitBtn">emit echo</button>
  </body>
  <script src="./socket.io/socket.io.js"></script>
  <script>
    const connPath = (location.pathname).split('/').slice(0, -1).join('/');
    const searchParams = new URLSearchParams(location.search);

    const socket = io({
      path: `${connPath}/socket.io/`,
    });
    console.log(`Connecting to ${connPath}`);

    socket.on('connect', () => {
      console.log('接続完了!');
      if (searchParams.has('id')){
        socket.emit('joinRoom', searchParams.get('id'));
        console.log(`JoinRoom ${searchParams.get('id')}`);
      }
    });
    
    socket.on('echo', text => {
      console.log(text);
    });

    document.getElementById('emitBtn').onclick = () => {
      console.log('emit message to server');
      socket.emit('echo', 'hello from client!');
    };
  </script>
</html>